if (T){
a <- 'brayagnes'
t <- tbrayagnes
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)}
if (T){
a <- 'brayflex25'
t <- tbrayflex25
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)}
if (T){
k=3
a <- 'brayward'
t <- tbrayward
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)
}
if (F){
k=6
a <- 'brayflex15'
t <- tbrayflex15
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)
}
if (F){
k=6
a <- 'braydiana'
t <- tbraydiana
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)
}
indicators <- indgroup(p.normal, groups, F)
indicators2 <- indgroup2(p.normal, groups, F)
iplot <- indicators2[[1]]
gplot <- indicators2[[2]]
aplot <- indicators2[[3]]
#dclust <- clustvar(d, groups)
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
indanalysis2
p.normal
timeA = Sys.time()
indob <- indanalysis2(p.normal)
plotdata.total <- apply(p.normal, MARGIN = 2, FUN = 'sum')
plotdata.total <- as.data.frame(cbind(name=names(plotdata.total),total=plotdata.total))
removetaxon <- plotdata.total[plotdata.total$total %in% 0,]$name
plotdata1 <- plotdata[,!colnames(plotdata) %in% removetaxon]
distbray <- vegdist(plotdata1, method='bray', binary=FALSE, na.rm=T)# dbray <- as.data.frame(as.matrix(distbray))
distjac <- vegdist(plotdata1, method='jaccard', binary=FALSE, na.rm=T)
distsim <- as.dist(simil(plotdata1,method='Simpson'))
distkulc <- vegdist(plotdata1, method='kulczynski', binary=FALSE, na.rm=T)
tbrayagnes <- distbray %>% agnes(method = 'average')
tbrayflex05 <- distbray %>% flexbeta(beta= -0.05)
tbrayflex10 <- distbray %>% flexbeta(beta= -0.10)
tbrayflex15 <- distbray %>% flexbeta(beta= -0.15)
tbrayflex20 <- distbray %>% flexbeta(beta= -0.20)
tbrayflex25 <- distbray %>% flexbeta(beta= -0.25)
tbrayflex30 <- distbray %>% flexbeta(beta= -0.30)
tbrayflex35 <- distbray %>% flexbeta(beta= -0.35)
tbrayward <- distbray %>% agnes(method = 'ward')
tbraydiana <- distbray %>% diana
tsimpagnes <- distsim %>% agnes(method = 'average')
tjacagnes <- distjac %>% agnes(method = 'average')
tkulcagnes <- distkulc %>% agnes(method = 'average')
tkulcward <- distkulc %>% agnes(method = 'ward')
klevel <- 0
ind.upgma <- 0
ind.flex05 <- 0
ind.flex10 <- 0
ind.flex15 <- 0
ind.flex20 <- 0
ind.flex25 <- 0
ind.flex30 <- 0
ind.flex35 <- 0
ind.ward <- 0
ind.jac <- 0
ind.sim <- 0
ind.diana <- 0
ind.kmeans <- 0
ind.kulc <- 0
ind.kward <- 0
weak.upgma <- 0
weak.flex05 <- 0
weak.flex10 <- 0
weak.flex15 <- 0
weak.flex20 <- 0
weak.flex25 <- 0
weak.flex30 <- 0
weak.flex35 <- 0
weak.ward <- 0
weak.jac <- 0
weak.sim <- 0
weak.diana <- 0
weak.kmeans <- 0
weak.kulc <- 0
weak.kward <- 0
plotdata.total
nrow(plotdata1)
p.normal
nrow(as.matrix(plotdata1))
nrow(as.data.frame(plotdata1))
plotdata1
nrow(as.data.frame(p.normal)
)
plotdata1 <- p.normal
distbray <- vegdist(plotdata1, method='bray', binary=FALSE, na.rm=T)# dbray <- as.data.frame(as.matrix(distbray))
distjac <- vegdist(plotdata1, method='jaccard', binary=FALSE, na.rm=T)
distsim <- as.dist(simil(plotdata1,method='Simpson'))
distkulc <- vegdist(plotdata1, method='kulczynski', binary=FALSE, na.rm=T)
tbrayagnes <- distbray %>% agnes(method = 'average')
tbrayflex05 <- distbray %>% flexbeta(beta= -0.05)
tbrayflex10 <- distbray %>% flexbeta(beta= -0.10)
tbrayflex15 <- distbray %>% flexbeta(beta= -0.15)
tbrayflex20 <- distbray %>% flexbeta(beta= -0.20)
tbrayflex25 <- distbray %>% flexbeta(beta= -0.25)
tbrayflex30 <- distbray %>% flexbeta(beta= -0.30)
tbrayflex35 <- distbray %>% flexbeta(beta= -0.35)
tbrayward <- distbray %>% agnes(method = 'ward')
tbraydiana <- distbray %>% diana
tsimpagnes <- distsim %>% agnes(method = 'average')
tjacagnes <- distjac %>% agnes(method = 'average')
tkulcagnes <- distkulc %>% agnes(method = 'average')
tkulcward <- distkulc %>% agnes(method = 'ward')
klevel <- 0
ind.upgma <- 0
ind.flex05 <- 0
ind.flex10 <- 0
ind.flex15 <- 0
ind.flex20 <- 0
ind.flex25 <- 0
ind.flex30 <- 0
ind.flex35 <- 0
ind.ward <- 0
ind.jac <- 0
ind.sim <- 0
ind.diana <- 0
ind.kmeans <- 0
ind.kulc <- 0
ind.kward <- 0
weak.upgma <- 0
weak.flex05 <- 0
weak.flex10 <- 0
weak.flex15 <- 0
weak.flex20 <- 0
weak.flex25 <- 0
weak.flex30 <- 0
weak.flex35 <- 0
weak.ward <- 0
weak.jac <- 0
weak.sim <- 0
weak.diana <- 0
weak.kmeans <- 0
weak.kulc <- 0
weak.kward <- 0
nrow(plotdata1)
for (k in 2:min(nrow(plotdata1),15)){
ind.upgma.0 <- indgroup(plotdata1, cutree(tbrayagnes, k = k), F)
ind.flex05.0 <- indgroup(plotdata1, cutree(tbrayflex05, k = k), F)
ind.flex10.0 <- indgroup(plotdata1, cutree(tbrayflex10, k = k), F)
ind.flex15.0 <- indgroup(plotdata1, cutree(tbrayflex15, k = k), F)
ind.flex20.0 <- indgroup(plotdata1, cutree(tbrayflex20, k = k), F)
ind.flex25.0 <- indgroup(plotdata1, cutree(tbrayflex25, k = k), F)
ind.flex30.0 <- indgroup(plotdata1, cutree(tbrayflex30, k = k), F)
ind.flex35.0 <- indgroup(plotdata1, cutree(tbrayflex35, k = k), F)
ind.ward.0 <- indgroup(plotdata1, cutree(tbrayward, k = k), F)
ind.jac.0 <- indgroup(plotdata1, cutree(tjacagnes, k = k), F)
ind.sim.0 <- indgroup(plotdata1, cutree(tsimpagnes, k = k), F)
ind.diana.0 <- indgroup(plotdata1, cutree(tbraydiana, k = k), F)
ind.kmeans.0 <- indgroup(plotdata1, kmeans(distbray, centers = k)$cluster, F)
ind.kulc.0 <- indgroup(plotdata1, cutree(tkulcagnes, k = k), F)
ind.kward.0 <- indgroup(plotdata1, cutree(tkulcward, k = k), F)
ind.upgma.1 <- ind.upgma.0[,'total'] %>% mean()
ind.flex05.1 <- ind.flex05.0[,'total'] %>% mean()
ind.flex10.1 <- ind.flex10.0[,'total'] %>% mean()
ind.flex15.1 <- ind.flex15.0[,'total'] %>% mean()
ind.flex20.1 <- ind.flex20.0[,'total'] %>% mean()
ind.flex25.1 <- ind.flex25.0[,'total'] %>% mean()
ind.flex30.1 <- ind.flex30.0[,'total'] %>% mean()
ind.flex35.1 <- ind.flex35.0[,'total'] %>% mean()
ind.ward.1 <- ind.ward.0[,'total'] %>% mean()
ind.jac.1 <-  ind.jac.0[,'total'] %>% mean()
ind.sim.1 <- ind.sim.0[,'total'] %>% mean()
ind.diana.1 <- ind.diana.0[,'total'] %>% mean()
ind.kmeans.1 <- ind.kmeans.0[,'total'] %>% mean()
ind.kulc.1 <- ind.kulc.0[,'total'] %>% mean()
ind.kward.1 <- ind.kward.0[,'total'] %>% mean()
weak.upgma.1 <- ind.upgma.0[,'maxval'] %>% min()
weak.flex05.1 <- ind.flex05.0[,'maxval'] %>% min()
weak.flex10.1 <- ind.flex10.0[,'maxval'] %>% min()
weak.flex15.1 <- ind.flex15.0[,'maxval'] %>% min()
weak.flex20.1 <- ind.flex20.0[,'maxval'] %>% min()
weak.flex25.1 <- ind.flex25.0[,'maxval'] %>% min()
weak.flex30.1 <- ind.flex30.0[,'maxval'] %>% min()
weak.flex35.1 <- ind.flex35.0[,'maxval'] %>% min()
weak.ward.1 <- ind.ward.0[,'maxval'] %>% min()
weak.jac.1 <-  ind.jac.0[,'maxval'] %>% min()
weak.sim.1 <- ind.sim.0[,'maxval'] %>% min()
weak.diana.1 <- ind.diana.0[,'maxval'] %>% min()
weak.kmeans.1 <- ind.kmeans.0[,'maxval'] %>% min()
weak.kulc.1 <- ind.kulc.0[,'maxval'] %>% min()
weak.kward.1 <- ind.kward.0[,'maxval'] %>% min()
klevel <- c(klevel, k)
ind.upgma <- c(ind.upgma, ind.upgma.1)
ind.flex05 <- c(ind.flex05, ind.flex05.1)
ind.flex10 <- c(ind.flex10, ind.flex10.1)
ind.flex15 <- c(ind.flex15, ind.flex15.1)
ind.flex20 <- c(ind.flex20, ind.flex20.1)
ind.flex25 <- c(ind.flex25, ind.flex25.1)
ind.flex30 <- c(ind.flex30, ind.flex30.1)
ind.flex35 <- c(ind.flex35, ind.flex35.1)
ind.ward <- c(ind.ward, ind.ward.1)
ind.jac <- c(ind.jac, ind.jac.1)
ind.sim <- c(ind.sim, ind.sim.1)
ind.diana <- c(ind.diana, ind.diana.1)
ind.kmeans <- c(ind.kmeans, ind.kmeans.1)
ind.kulc <- c(ind.kulc, ind.kulc.1)
ind.kward <- c(ind.kward, ind.kward.1)
weak.upgma <- c(weak.upgma, weak.upgma.1)
weak.flex05 <- c(weak.flex05, weak.flex05.1)
weak.flex10 <- c(weak.flex10, weak.flex10.1)
weak.flex15 <- c(weak.flex15, weak.flex15.1)
weak.flex20 <- c(weak.flex20, weak.flex20.1)
weak.flex25 <- c(weak.flex25, weak.flex25.1)
weak.flex30 <- c(weak.flex30, weak.flex30.1)
weak.flex35 <- c(weak.flex35, weak.flex35.1)
weak.ward <- c(weak.ward, weak.ward.1)
weak.jac <- c(weak.jac, weak.jac.1)
weak.sim <- c(weak.sim, weak.sim.1)
weak.diana <- c(weak.diana, weak.diana.1)
weak.kmeans <- c(weak.kmeans, weak.kmeans.1)
weak.kulc <- c(weak.kulc, weak.kulc.1)
weak.kward <- c(weak.kward, weak.kward.1)
}
k
klevel <- 0
ind.upgma <- 0
ind.flex05 <- 0
ind.flex10 <- 0
ind.flex15 <- 0
ind.flex20 <- 0
ind.flex25 <- 0
ind.flex30 <- 0
ind.flex35 <- 0
ind.ward <- 0
ind.jac <- 0
ind.sim <- 0
ind.diana <- 0
ind.kmeans <- 0
ind.kulc <- 0
ind.kward <- 0
weak.upgma <- 0
weak.flex05 <- 0
weak.flex10 <- 0
weak.flex15 <- 0
weak.flex20 <- 0
weak.flex25 <- 0
weak.flex30 <- 0
weak.flex35 <- 0
weak.ward <- 0
weak.jac <- 0
weak.sim <- 0
weak.diana <- 0
weak.kmeans <- 0
weak.kulc <- 0
weak.kward <- 0
for (k in 2:min(nrow(plotdata1)-1,15)){
ind.upgma.0 <- indgroup(plotdata1, cutree(tbrayagnes, k = k), F)
ind.flex05.0 <- indgroup(plotdata1, cutree(tbrayflex05, k = k), F)
ind.flex10.0 <- indgroup(plotdata1, cutree(tbrayflex10, k = k), F)
ind.flex15.0 <- indgroup(plotdata1, cutree(tbrayflex15, k = k), F)
ind.flex20.0 <- indgroup(plotdata1, cutree(tbrayflex20, k = k), F)
ind.flex25.0 <- indgroup(plotdata1, cutree(tbrayflex25, k = k), F)
ind.flex30.0 <- indgroup(plotdata1, cutree(tbrayflex30, k = k), F)
ind.flex35.0 <- indgroup(plotdata1, cutree(tbrayflex35, k = k), F)
ind.ward.0 <- indgroup(plotdata1, cutree(tbrayward, k = k), F)
ind.jac.0 <- indgroup(plotdata1, cutree(tjacagnes, k = k), F)
ind.sim.0 <- indgroup(plotdata1, cutree(tsimpagnes, k = k), F)
ind.diana.0 <- indgroup(plotdata1, cutree(tbraydiana, k = k), F)
ind.kmeans.0 <- indgroup(plotdata1, kmeans(distbray, centers = k)$cluster, F)
ind.kulc.0 <- indgroup(plotdata1, cutree(tkulcagnes, k = k), F)
ind.kward.0 <- indgroup(plotdata1, cutree(tkulcward, k = k), F)
ind.upgma.1 <- ind.upgma.0[,'total'] %>% mean()
ind.flex05.1 <- ind.flex05.0[,'total'] %>% mean()
ind.flex10.1 <- ind.flex10.0[,'total'] %>% mean()
ind.flex15.1 <- ind.flex15.0[,'total'] %>% mean()
ind.flex20.1 <- ind.flex20.0[,'total'] %>% mean()
ind.flex25.1 <- ind.flex25.0[,'total'] %>% mean()
ind.flex30.1 <- ind.flex30.0[,'total'] %>% mean()
ind.flex35.1 <- ind.flex35.0[,'total'] %>% mean()
ind.ward.1 <- ind.ward.0[,'total'] %>% mean()
ind.jac.1 <-  ind.jac.0[,'total'] %>% mean()
ind.sim.1 <- ind.sim.0[,'total'] %>% mean()
ind.diana.1 <- ind.diana.0[,'total'] %>% mean()
ind.kmeans.1 <- ind.kmeans.0[,'total'] %>% mean()
ind.kulc.1 <- ind.kulc.0[,'total'] %>% mean()
ind.kward.1 <- ind.kward.0[,'total'] %>% mean()
weak.upgma.1 <- ind.upgma.0[,'maxval'] %>% min()
weak.flex05.1 <- ind.flex05.0[,'maxval'] %>% min()
weak.flex10.1 <- ind.flex10.0[,'maxval'] %>% min()
weak.flex15.1 <- ind.flex15.0[,'maxval'] %>% min()
weak.flex20.1 <- ind.flex20.0[,'maxval'] %>% min()
weak.flex25.1 <- ind.flex25.0[,'maxval'] %>% min()
weak.flex30.1 <- ind.flex30.0[,'maxval'] %>% min()
weak.flex35.1 <- ind.flex35.0[,'maxval'] %>% min()
weak.ward.1 <- ind.ward.0[,'maxval'] %>% min()
weak.jac.1 <-  ind.jac.0[,'maxval'] %>% min()
weak.sim.1 <- ind.sim.0[,'maxval'] %>% min()
weak.diana.1 <- ind.diana.0[,'maxval'] %>% min()
weak.kmeans.1 <- ind.kmeans.0[,'maxval'] %>% min()
weak.kulc.1 <- ind.kulc.0[,'maxval'] %>% min()
weak.kward.1 <- ind.kward.0[,'maxval'] %>% min()
klevel <- c(klevel, k)
ind.upgma <- c(ind.upgma, ind.upgma.1)
ind.flex05 <- c(ind.flex05, ind.flex05.1)
ind.flex10 <- c(ind.flex10, ind.flex10.1)
ind.flex15 <- c(ind.flex15, ind.flex15.1)
ind.flex20 <- c(ind.flex20, ind.flex20.1)
ind.flex25 <- c(ind.flex25, ind.flex25.1)
ind.flex30 <- c(ind.flex30, ind.flex30.1)
ind.flex35 <- c(ind.flex35, ind.flex35.1)
ind.ward <- c(ind.ward, ind.ward.1)
ind.jac <- c(ind.jac, ind.jac.1)
ind.sim <- c(ind.sim, ind.sim.1)
ind.diana <- c(ind.diana, ind.diana.1)
ind.kmeans <- c(ind.kmeans, ind.kmeans.1)
ind.kulc <- c(ind.kulc, ind.kulc.1)
ind.kward <- c(ind.kward, ind.kward.1)
weak.upgma <- c(weak.upgma, weak.upgma.1)
weak.flex05 <- c(weak.flex05, weak.flex05.1)
weak.flex10 <- c(weak.flex10, weak.flex10.1)
weak.flex15 <- c(weak.flex15, weak.flex15.1)
weak.flex20 <- c(weak.flex20, weak.flex20.1)
weak.flex25 <- c(weak.flex25, weak.flex25.1)
weak.flex30 <- c(weak.flex30, weak.flex30.1)
weak.flex35 <- c(weak.flex35, weak.flex35.1)
weak.ward <- c(weak.ward, weak.ward.1)
weak.jac <- c(weak.jac, weak.jac.1)
weak.sim <- c(weak.sim, weak.sim.1)
weak.diana <- c(weak.diana, weak.diana.1)
weak.kmeans <- c(weak.kmeans, weak.kmeans.1)
weak.kulc <- c(weak.kulc, weak.kulc.1)
weak.kward <- c(weak.kward, weak.kward.1)
}
source('clusterfunctions.R')
newnames <- paste0('t',str_pad(round(overstorycover$overstorycover, 0), 2,'left',0),'s',str_pad(round(overstorycover$shrubcover, 0), 2,'left',0), overstorycover$soilplot)
plotdatax <- plotdata
rownames(plotdatax) <- newnames
shrubplots <- subset(overstorycover, shrubcover >= 10 & overstorycover < 10)$soilplot
plotdata.shrub <- subset(plotdata, rownames(plotdata) %in%  shrubplots )
openplots <- subset(overstorycover, shrubcover < 10 & overstorycover < 10)$soilplot
plotdata.open <- subset(plotdata, rownames(plotdata) %in%  openplots )
openplots <- subset(overstorycover, shrubcover < 10 & overstorycover < 10)$soilplot
plotdata.open <- subset(plotdata, rownames(plotdata) %in%  c(openplots,shrubplots) )
forestplots <- subset(overstorycover, overstorycover >= 10)$soilplot
plotdata.forest <- subset(plotdata, rownames(plotdata) %in%  forestplots )
p.normal <- cleanplotdata(plotdata.open)
#group parameters ----
# beta= -0.25
# k = 4
# d <- vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
# tbeta <- d %>% flexbeta(beta= beta) %>% dendsort()
# tward <- agnes(d, method = 'ward') %>% as.hclust() %>% dendsort()
# dk <- dynamicK(t, d)
# dkward <- dynamicK(tward, d)
# groups <- cutree(t, k = k)
# maxCoreScatter <- dk[dk$nclust %in% k,]$maxcor
# minGap <- (1 - maxCoreScatter) * 3/4
# dyngroups <-
#   cutreeDynamic(t, minClusterSize=1, method = 'hybrid', distM=as.matrix(d),deepSplit=1, maxCoreScatter=maxCoreScatter, minGap=minGap, maxAbsCoreScatter=NULL, minAbsGap=NULL)
# groups=dyngroups
# groups <- cutree(t, k = k)
# groups <- grouporder(t, groups)
# grouporder <- function(t,groups){
# soilplot <- names(d)
# clust <- unname(groups)
# groupdf <- as.data.frame(cbind(soilplot, clust))
# groupdf$clust <- (as.numeric(as.character(groupdf$clust)))
# torder <- as.data.frame(cbind(trow=t$order))
# torder$torder <- row(torder)[,1]
# newlabels <- as.data.frame(cbind(labels=t$labels))
# newlabels$trow <- row(newlabels)[,1]
# newlabels <- merge(newlabels, groupdf, by.x='labels', by.y ='soilplot')
# newlabels <- merge(newlabels, torder, by='trow')
#
# grouporder <- newlabels %>% group_by(clust)  %>%  summarise(thisorder = min(torder))
# grouporder$newgroup <- order(order(grouporder$thisorder))
# newlabels <- merge(newlabels, grouporder, by='clust')
# newgroups <- newlabels$newgroup
# names(newgroups) <- newlabels$labels
# return(newgroups)
# }
# newlabels$newlabels <- paste(newlabels$clust, newlabels$newlabels)
# newlabels <- newlabels[order(newlabels$row),1]
# newtree <- t
# newtree$labels <- newlabels
beta= -0.25
k = 3
d <- vegdist(p.normal, method='bray', binary=FALSE, na.rm=T)
tbeta <- d %>% flexbeta(beta= beta) %>% dendsort()
tward <- agnes(d, method = 'ward') %>% as.hclust() %>% dendsort()
t <- tbeta
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'flex'
makeplotgroup(a,d,t,groups)
}
t <- tward
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'ward'
makeplotgroup(a,d,t,groups)
}
distsim <- as.dist(simil(p.normal,method='Simpson'))
distkulc <- vegdist(p.normal, method='kulczynski', binary=FALSE, na.rm=T)
distbray <- vegdist(p.normal, method='bray', binary=FALSE, na.rm=T)
tbrayagnes <- distbray %>% agnes(method = 'average') %>% as.hclust() %>% dendsort()
tsimpagnes <- distsim %>% agnes(method = 'average') %>% as.hclust() %>% dendsort()
tkulcagnes <- distkulc %>% agnes(method = 'average')%>% as.hclust() %>% dendsort()
tbrayflex25 <- distbray %>% flexbeta(beta= -0.25) %>% as.hclust() %>% dendsort()
tbrayflex15 <- distbray %>% flexbeta(beta= -0.15) %>% as.hclust() %>% dendsort()
tbrayward <- distbray %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
tbraydiana <- distbray %>% diana() %>% as.hclust() %>% dendsort()
if (T){
a <- 'kulcagnes'
t <- tkulcagnes
d <- distkulc
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)}
if (T){
a <- 'simpagnes'
t <- tsimpagnes
d <- distsim
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)
}
if (T){
a <- 'brayagnes'
t <- tbrayagnes
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)}
if (T){
a <- 'brayflex25'
t <- tbrayflex25
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)}
if (T){
k=3
a <- 'brayward'
t <- tbrayward
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)
}
if (F){
k=6
a <- 'brayflex15'
t <- tbrayflex15
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)
}
if (F){
k=6
a <- 'braydiana'
t <- tbraydiana
d <- distbray
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
makeplotgroup(a,d,t,groups)
}
indicators <- indgroup(p.normal, groups, F)
indicators2 <- indgroup2(p.normal, groups, F)
iplot <- indicators2[[1]]
gplot <- indicators2[[2]]
aplot <- indicators2[[3]]
#dclust <- clustvar(d, groups)
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
timeA = Sys.time()
indob <- indanalysis2(p.normal)
Sys.time() - timeA
ind.table <- indob[[1]]
dni.table <- indob[[2]]
weak.table <- indob[[3]]
kaew.table <- indob[[4]]
Sys.time() - timeA
View(dni.table)
View(weak.table)
