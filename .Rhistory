d2 <-  (w * d.x) + ((1 - w) * d.y)
fd <- vegdist(functionalcover, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
View(dtable)
d <-  (d.x+d.y)/2
dtable <- d %>% as.matrix()
fd <- vegdist(functionalcover, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 10
t  <- d %>% agnes(method = 'average') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
#functional ----
fd <- vegdist(functionalcover, method = 'euclidean')
d.y = vegdist(plotdata, method='ward', binary=FALSE, na.rm=T)
fd <- vegdist(functionalcover, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
d <- d.x
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 10
t  <- d %>% agnes(method = 'average') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
fd <- vegdist(functionalcover, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 10
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
k = 5
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
View(exoticover)
View(functionalcover)
functionalcover$soilplot <- rownames(functionalcover)
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- cbind(functionalcover, groups)
View(functionalcover.groups)
fd <- vegdist(functionalcover, method = 'euclidean')
library(soilDB)
library(aqp)#load before dplyr
library(stringr)
library(BiodiversityR)
library(cluster)
library(ape)
library(dendextend)
library(dplyr)
library(dynamicTreeCut)
library(rpart)
library(rpart.plot)
library(goeveg)
library(proxy)
library(foreign)
library(optpart)
library(dendsort)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
#load clustering functions ----
source('clusterfunctions.R')
# Load Veg tables ----
source('processplot.R')
source('functionalveg.R')
#run separate open vs forest analyses
newnames <- paste0('t',str_pad(round(overstorycover$overstorycover, 0), 2,'left',0),'s',str_pad(round(overstorycover$shrubcover, 0), 2,'left',0), overstorycover$soilplot)
plotdatax <- plotdata
rownames(plotdatax) <- newnames
shrubplots <- subset(overstorycover, shrubcover >= 10 & overstorycover < 10)$soilplot
plotdata.shrub <- subset(plotdata, rownames(plotdata) %in%  shrubplots )
openplots <- subset(overstorycover, shrubcover < 10 & overstorycover < 10)$soilplot
plotdata.open <- subset(plotdata, rownames(plotdata) %in%  openplots )
openplots <- subset(overstorycover, shrubcover < 10 & overstorycover < 10)$soilplot
plotdata.open <- subset(plotdata, rownames(plotdata) %in%  c(openplots,shrubplots) )
forestplots <- subset(overstorycover, overstorycover >= 10)$soilplot
plotdata.forest <- subset(plotdata, rownames(plotdata) %in%  forestplots )
plotdata.open.normal <- cleanplotdata(plotdata.open)
plotdata.forest.normal <- cleanplotdata(plotdata.forest)
timeA = Sys.time()
indob <- indanalysis2(plotdata.open.normal)
Sys.time() - timeA
open.ind.table <- indob[[1]]
open.dni.table <- indob[[2]]
open.weak.table <- indob[[3]]
open.kaew.table <- indob[[4]]
Sys.time() - timeA
timeA = Sys.time()
indob <- indanalysis2(plotdata.forest.normal)
Sys.time() - timeA
forest.ind.table <- indob[[1]]
forest.dni.table <- indob[[2]]
forest.weak.table <- indob[[3]]
forest.kaew.table <- indob[[4]]
Sys.time() - timeA
p1=plotdata.forest.normal
d <- vegdist(p1, method='bray', binary=FALSE, na.rm=T)
k = 3
t  <- d %>% flexbeta(beta= -0.1) %>% as.hclust() %>% dendsort()
#forest ----
p1=plotdata.forest.normal
d <- vegdist(p1, method='bray', binary=FALSE, na.rm=T)
k = 3
t  <- d %>% flexbeta(beta= -0.1) %>% as.hclust() %>% dendsort()
# t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'forest'
makeplotgroup(a,d,t,groups)
}
indicators <- indgroup(p1, groups, F)
indicators2 <- indgroup2(p1, groups, F)
iplot <- indicators2[[1]]
gplot <- indicators2[[2]]
aplot <- indicators2[[3]]
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
#open ----
p1=plotdata.open.normal
d <- vegdist(p1, method='bray', binary=FALSE, na.rm=T)
# d <- vegdist(p1, method='kulczynski', binary=FALSE, na.rm=T)
k = 3
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'open'
makeplotgroup(a,d,t,groups)
}
indicators <- indgroup(p1, groups, F)
indicators2 <- indgroup2(p1, groups, F)
iplot <- indicators2[[1]]
gplot <- indicators2[[2]]
aplot <- indicators2[[3]]
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
#functional ----
fd <- vegdist(functionalcover, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
d <- d.y
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- functionalcover %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover, groups)
functionalcover2 <- functionalcover %>% mutate(overstorycover = ifelse(overstorycover >= 10, 100,0),
Exotic = ifelse(Exotic >= 10, 100,0),
wetness = ifelse(wetness >= 50, 100,0),
Deciduous = ifelse(Deciduous >= 10, 100,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
d <- d.y
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- functionalcover %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover2 <- functionalcover %>% mutate(overstorycover = ifelse(overstorycover >= 10, 100,0),
Exotic = ifelse(Exotic >= 10, 100,0),
wetness = ifelse(wetness >= 50, 100,0),
Deciduous = ifelse(Deciduous >= 10, 100,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- functionalcover %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
View(plotdata)
subset(plotdata, select=Cephalanthus.occidentalis )
buttonbush  = functionalcover %>% cbind(subset(plotdata, select=Cephalanthus.occidentalis))
View(buttonbush)
functionalcover2 <- buttonbush %>% mutate(overstorycover = ifelse(overstorycover >= 10, 100,0),
Exotic = ifelse(Exotic >= 10, 100,0),
wetness = ifelse(wetness >= 50, 100,0),
Deciduous = ifelse(Deciduous >= 10, 100,0),
Cephalanthus.occidentalis = ifelse(Cephalanthus.occidentalis >= 1, 100,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- functionalcover %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover.groups <- buttonbush %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover2 <- buttonbush %>% mutate(overstorycover = ifelse(overstorycover >= 10, 100,0),
Exotic = ifelse(Exotic >= 10, 100,0),
wetness = ifelse(wetness >= 50, 100,0),
Deciduous = ifelse(Deciduous >= 10, 100,0),
Cephalanthus.occidentalis = ifelse(Cephalanthus.occidentalis >= 2, 100,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- buttonbush %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
#group parameters ----
functionalcover2 <- buttonbush %>% mutate(overstorycover = ifelse(overstorycover >= 10, 100,0),
Exotic = ifelse(Exotic >= 10, 100,0),
wetness = ifelse(wetness >= 50, 100,0),
Deciduous = ifelse(Deciduous >= 10, 100,0),
Cephalanthus.occidentalis = ifelse(Cephalanthus.occidentalis >= 2, 500,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- buttonbush %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover2 <- buttonbush %>% mutate(overstorycover = ifelse(overstorycover >= 10, 100,0),
Exotic = ifelse(Exotic >= 10, 200,0),
wetness = ifelse(wetness >= 50, 100,0),
Deciduous = ifelse(Deciduous >= 10, 100,0),
Cephalanthus.occidentalis = ifelse(Cephalanthus.occidentalis >= 2, 500,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- buttonbush %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover2 <- buttonbush %>% mutate(overstorycover = ifelse(overstorycover >= 10, 200,0),
Exotic = ifelse(Exotic >= 10, 200,0),
wetness = ifelse(wetness >= 50, 200,0),
Deciduous = ifelse(Deciduous >= 10, 100,0),
Cephalanthus.occidentalis = ifelse(Cephalanthus.occidentalis >= 2, 500,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- buttonbush %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover2 <- buttonbush %>% mutate(overstorycover = ifelse(overstorycover >= 10, 200,0),
Exotic = ifelse(Exotic >= 10, 200,0),
wetness = ifelse(wetness >= 50, 200,0),
#Deciduous = ifelse(Deciduous >= 10, 100,0),
Cephalanthus.occidentalis = ifelse(Cephalanthus.occidentalis >= 2, 500,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 8
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- buttonbush %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover2 <- buttonbush %>% mutate(overstorycover = ifelse(overstorycover >= 10, 200,0),
Exotic = ifelse(Exotic >= 10, 200,0),
wetness = ifelse(wetness >= 50, 200,0),
#Deciduous = ifelse(Deciduous >= 10, 100,0),
Cephalanthus.occidentalis = ifelse(Cephalanthus.occidentalis >= 2, 500,0)
)
fd <- vegdist(functionalcover2, method = 'euclidean')
d.y = vegdist(plotdata, method='bray', binary=FALSE, na.rm=T)
d.x <- (fd - min(as.matrix(fd)))/(max(as.matrix(fd))-min(as.matrix(fd)))
w=0.5
d <-  (w * d.x) + ((1 - w) * d.y)
dtable <- d %>% as.matrix()
fdtable <- fd %>% as.matrix()
k = 7
t  <- d %>% agnes(method = 'ward') %>% as.hclust() %>% dendsort()
groups <- cutree(t, k = k)
groups <- grouporder(t, groups)
if (T){
a <- 'functional groups'
makeplotgroup(a,d,t,groups)
}
source('groupplotsummary.R')
source('USNVC_compare_specieslists_loop_by_cluster.R')
source('run.aggregate_plot_summary.R')
Com.Structure[order(as.numeric(as.character(Com.Structure$cluster))),c("cluster", "association", "WetStructure")]
plotassociations[order(as.numeric(as.character(plotassociations$clust))),c("clust", "scientificname")]
functionalcover.groups <- buttonbush %>% mutate(soilplot = rownames(functionalcover))
functionalcover.groups <- cbind(functionalcover.groups, groups)
functionalcover.summary <- functionalcover.groups %>% group_by(soilplot) %>% summarise(Exotic=mean(Exotic),
wetness=mean(wetness),
Deciduous=mean(Deciduous),
Evergreen=mean(Evergreen),
Trees=mean(overstorycover))
View(functionalcover.summary)
functionalcover.summary <- functionalcover.groups %>% group_by(groups) %>% summarise(Exotic=mean(Exotic),
wetness=mean(wetness),
Deciduous=mean(Deciduous),
Evergreen=mean(Evergreen),
Trees=mean(overstorycover))
